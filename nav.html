<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>资源目录 - 智慧物联网教学支持平台</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <style>
    /* 可以在 style.css 中定义这些，这里为了方便展示 */
    #no-preview-placeholder {
      display: flex; /* 初始状态由 main.js 控制显示/隐藏 */
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      height: 100%; /* 填充容器 */
      color: #6b7280; 
      background-color: #fff; 
      border-radius: 8px; 
      box-shadow: 0 4px 8px rgba(0,0,0,0.05); 
    }
    #no-preview-placeholder p {
        font-size: 1.1rem;
    }
    /* 加载动画样式 (如果 style.css 中没有，则需要添加) */
    .loader {
      border: 5px solid #e5e7eb; /* 浅灰色轨道 */
      border-top: 5px solid #2563eb; /* 蓝色旋转部分 */
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 30px auto; /* 上下居中一点 */
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* 翻页控件样式 (可移至 style.css) - Office Online Viewer不需要这些外部控件 */
    .slide-controls {
      /* display: flex; */ /* 已由JS控制隐藏，这里可以注释掉或移除 */
      justify-content: center;
      align-items: center;
      padding: 8px 0;
      margin-top: 8px; 
      border-top: 1px solid #e5e7eb; 
    }
    .slide-controls button {
      background-color: #4a5568; 
      color: white;
      border: none;
      padding: 8px 12px;
      margin: 0 5px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }
    .slide-controls button:disabled {
      background-color: #a0aec0; 
      cursor: not-allowed;
    }
    .slide-info {
      margin: 0 15px;
      font-size: 0.9em;
      color: #4a5568;
    }
  </style>
</head>
<body id="page-nav">
  <header><h1>资源目录</h1></header>
  <div class="container flex">
    <aside class="aside">
      <button id="btn-back-home" class="nav-btn">← 首页</button>
      <h2 id="nav-title"></h2>
      <ul id="sections-list"></ul>
    </aside>
    <div class="flex-1 p-4">
      <div class="preview-area hidden bg-white rounded-lg shadow h-full" id="preview-area">
        <div class="preview-toolbar mb-2 p-2">
          <a id="download-btn" href="#" download class="toolbar-btn">下载</a>
          <button id="fullscreen-btn" class="toolbar-btn">全屏</button>
        </div>
        <div class="preview-container preview-content" id="preview-content">
            </div>
        <div class="slide-controls hidden" id="slide-navigation-controls">
            <button id="prev-slide-btn" title="上一页">‹ 上一页</button>
            <span id="slide-info" class="slide-info">幻灯片 1 / 1</span>
            <button id="next-slide-btn" title="下一页">下一页 ›</button>
        </div>
      </div>
      <div id="no-preview-placeholder">
        <p>请在左侧选择一个资源进行预览。</p>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="main.js" defer></script>
</body>
</html>
